syntax = "proto3";

package sso.v1;

import "sso/v1/sso.proto";

import "google/api/annotations.proto";

option go_package = "github.com/kitanoyoru/kgym/contracts/protobuf/gen/go/sso/v1;sso";

service SSOService {
    rpc GetToken(GetToken.Request) returns (GetToken.Response) {
        option (google.api.http) = {
            post: "/api/v1/oauth/token"
            body: "*"
        };
    }

    rpc GetJWKS(GetJWKS.Request) returns (GetJWKS.Response) {
        option (google.api.http) = {
            get: "/.well-known/jwks.json"
        };
    }
}

message GetToken {
    message Request {
        oneof grant {
            PasswordGrant password_grant = 1;
            RefreshTokenGrant refresh_token_grant = 2;
        }

        string client_id = 3;
    }

    message Response {
        Token token = 1;
    }
}

message PasswordGrant {
    string username = 1;
    string password = 2;
}

message RefreshTokenGrant {
    string refresh_token = 1;
}

message GetJWKS {
    message Request {
    }

    message Response {
        repeated Key keys = 1;
    }
}
